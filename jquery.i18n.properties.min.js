(function(l){function u(a){a.debug&&(f("callbackIfComplete()"),f("totalFiles: "+a.totalFiles),f("filesLoaded: "+a.filesLoaded));a.async&&a.filesLoaded===a.totalFiles&&a.callback&&a.callback()}function q(a,c){c.debug&&f("loadAndParseFiles");null!==a&&0<a.length?v(a[0],c,function(){a.shift();q(a,c)}):u(c)}function v(a,c,h){c.debug&&(f("loadAndParseFile('"+a+"')"),f("totalFiles: "+c.totalFiles),f("filesLoaded: "+c.filesLoaded));null!==a&&"undefined"!==typeof a&&l.ajax({url:a,async:c.async,cache:c.cache,
dataType:"text",contentType:"Content-type: text/plain; charset="+c.encoding,beforeSend:function(a){a.overrideMimeType("text/html;charset="+c.encoding)},success:function(e,b){c.debug&&(f("Succeeded in downloading "+a+"."),f(e));w(e,c);h()},error:function(e,b,d){c.debug&&f("Failed to download or parse "+a+". errorThrown: "+d);404===e.status&&(c.totalFiles-=1);h()}})}function w(a,c){for(var h="",e=a.split(/\n/),b=/(\{\d+})/g,d=/\{(\d+)}/g,f=/(\\u.{4})/ig,g=0,p=e.length;g<p;g++){var m=e[g],m=m.trim();
if(0<m.length&&"#"!=m.match("^#")){var n=m.split("=");if(0<n.length){for(var m=decodeURI(n[0]).trim(),k=1==n.length?"":n[1];-1!=k.search(/\\$/);)k=k.substring(0,k.length-1),k+=e[++g].replace(/\s+$/,"");for(var s=2;s<n.length;s++)k+="="+n[s];k=k.trim();if("map"==c.mode||"both"==c.mode)(n=k.match(f))&&n.forEach(function(a){k=k.replace(a,x(a))}),c.namespace?l.i18n.map[c.namespace][m]=k:l.i18n.map[m]=k;if("vars"==c.mode||"both"==c.mode)if(k=k.replace(/"/g,'\\"'),y(m),b.test(k)){var q=!0,r="",t=[];k.split(b).forEach(function(a){if(b.test(a)&&
(0===t.length||-1==t.indexOf(a)))q||(r+=","),r+=a.replace(d,"v$1"),t.push(a),q=!1});h+=m+"=function("+r+"){";m='"'+k.replace(d,'"+v$1+"')+'"';h+="return "+m+";};"}else h+=m+'="'+k+'";'}}}eval(h);c.filesLoaded+=1}function y(a){if(/\./.test(a)){var c="";a=a.split(/\./);for(var h=0,e=a.length;h<e;h++){var b=a[h];0<h&&(c+=".");c+=b;eval("typeof "+c+' == "undefined"')&&eval(c+"={};")}}}function x(a){var c=[];a=parseInt(a.substr(2),16);0<=a&&a<Math.pow(2,16)&&c.push(a);return c.reduce(function(a,c){return a+
String.fromCharCode(c)},"")}l.i18n={};l.i18n.map={};var f=function(a){window.console&&console.log("i18n::"+a)};l.i18n.properties=function(a){a=l.extend({name:"Messages",language:"",path:"",namespace:null,mode:"vars",cache:!1,debug:!1,encoding:"UTF-8",async:!1,callback:null},a);a.namespace&&"string"==typeof a.namespace&&(a.namespace.match(/^[a-z]*$/)?l.i18n.map[a.namespace]={}:(f("Namespaces can only be lower case letters, a - z"),a.namespace=null));a.path.match(/\/$/)||(a.path+="/");a.language=this.normaliseLanguageCode(a);
var c=a.name&&a.name.constructor===Array?a.name:[a.name];a.totalFiles=2*c.length+(5<=a.language.length?c.length:0);a.debug&&f("totalFiles: "+a.totalFiles);a.filesLoaded=0;c.forEach(function(c){var e,b;e=a.path+c+".properties";b=a.language.substring(0,2);b=a.path+c+"_"+b+".properties";if(5<=a.language.length){var d=a.language.substring(0,5);c=a.path+c+"_"+d+".properties";e=[e,b,c]}else e=[e,b];q(e,a)});a.callback&&!a.async&&a.callback()};l.i18n.prop=function(a){var c=[].slice.call(arguments),h,e;if(2==
c.length)if(l.isArray(c[1]))h=c[1];else if("object"===typeof c[1]){e=c[1].namespace;var b=c[1].replacements;c.splice(-1,1);b&&Array.prototype.push.apply(c,b)}b=e?l.i18n.map[e][a]:l.i18n.map[a];if(null===b||"undefined"===typeof b)return"["+(e?e+"#"+a:a)+"]";var d;if("string"==typeof b){for(d=0;-1!=(d=b.indexOf("\\",d));)b="t"==b.charAt(d+1)?b.substring(0,d)+"\t"+b.substring(d++ +2):"r"==b.charAt(d+1)?b.substring(0,d)+"\r"+b.substring(d++ +2):"n"==b.charAt(d+1)?b.substring(0,d)+"\n"+b.substring(d++ +
2):"f"==b.charAt(d+1)?b.substring(0,d)+"\f"+b.substring(d++ +2):"\\"==b.charAt(d+1)?b.substring(0,d)+"\\"+b.substring(d++ +2):b.substring(0,d)+b.substring(d+1);var f=[],g,p;for(d=0;d<b.length;)if("'"==b.charAt(d))if(d==b.length-1)b=b.substring(0,d);else if("'"==b.charAt(d+1))b=b.substring(0,d)+b.substring(++d);else{for(g=d+2;-1!=(g=b.indexOf("'",g));)if(g==b.length-1||"'"!=b.charAt(g+1)){b=b.substring(0,d)+b.substring(d+1,g)+b.substring(g+1);d=g-1;break}else b=b.substring(0,g)+b.substring(++g);-1==
g&&(b=b.substring(0,d)+b.substring(d+1))}else"{"==b.charAt(d)?(g=b.indexOf("}",d+1),-1==g?d++:(p=parseInt(b.substring(d+1,g)),!isNaN(p)&&0<=p?(d=b.substring(0,d),""!==d&&f.push(d),f.push(p),d=0,b=b.substring(g+1)):d=g+1)):d++;""!==b&&f.push(b);b=f;e?l.i18n.map[settings.namespace][a]=f:l.i18n.map[a]=f}if(0===b.length)return"";if(1==b.length&&"string"==typeof b[0])return b[0];e="";d=0;for(g=b.length;d<g;d++)e="string"==typeof b[d]?e+b[d]:h&&b[d]<h.length?e+h[b[d]]:!h&&b[d]+1<c.length?e+c[b[d]+1]:e+
("{"+b[d]+"}");return e};l.i18n.normaliseLanguageCode=function(a){var c=a.language;if(!c||2>c.length)a.debug&&f("No language supplied. Pulling it from the browser ..."),c=navigator.languages&&0<navigator.languages.length?navigator.languages[0]:navigator.language||navigator.userLanguage||"en",a.debug&&f("Language from browser: "+c);c=c.toLowerCase();c=c.replace(/-/,"_");3<c.length&&(c=c.substring(0,3)+c.substring(3).toUpperCase());return c}})(jQuery);
